# Migration `20200407224204-add_product_attribute`

This migration has been generated by Khoa Le at 4/7/2020, 10:42:04 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `next-js-cart`.`_attribute_valueToproduct` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `_attribute_valueToproduct_AB_unique` ON `next-js-cart`.`_attribute_valueToproduct`(`A`,`B`)

CREATE  INDEX `_attribute_valueToproduct_B_index` ON `next-js-cart`.`_attribute_valueToproduct`(`B`)

ALTER TABLE `next-js-cart`.`_attribute_valueToproduct` ADD FOREIGN KEY (`A`) REFERENCES `next-js-cart`.`attribute_value`(`attribute_value_id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `next-js-cart`.`_attribute_valueToproduct` ADD FOREIGN KEY (`B`) REFERENCES `next-js-cart`.`product`(`product_id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200407222635-update_relation..20200407224204-add_product_attribute
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model attribute {
   attribute_id Int    @default(autoincrement()) @id
@@ -15,8 +15,9 @@
 model attribute_value {
   attribute_id       Int
   attribute_value_id Int    @default(autoincrement()) @id
   value              String
+  products product[]
   @@index([attribute_id], name: "idx_attribute_value_attribute_id")
 }
@@ -105,8 +106,9 @@
   name             String
   price            Float
   product_id       Int     @default(autoincrement()) @id
   thumbnail        String?
+  attribute_values attribute_value[]
   categories category[]
   @@index([name, description], name: "idx_ft_product_name_description")
 }
```


